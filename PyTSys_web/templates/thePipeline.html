<!-- A Pipeline Page
    With a summary of the Status and some important buttons links
 -->
{% extends "base.html" %}
{% block CSSs %}
<link rel="stylesheet" href="{{ url_for('static', filename='styles/tables.css')}}">
{% endblock %}
{% block infoWindow %}
<title>PyTSys -A Pipelines</title>
{% endblock %}
{% block mainBody %}
<div class="objectLine allExpand">
    <button class="left aButton b3 s16 yesPadding yesMargin" onclick="location.href='/pipelines/'">
        <div class="objectLine">
            &#8617;
            <div class="objectLine">
                Back to <br /> Pipeline Menu
            </div>
        </div>
    </button>
    <h1>Pipeline {{numPipe}}: {{thePipeline.Name}}</h1>
</div>
<form action="/pipelines/new/" method="post" class="aform allExpand">
    <div class=" objectLine alingTop yes yesMargin">
        <div class=" allExpand  textLeft">
            <span> Total Steps: {{ thePipeline.steps()|length }} </span>

            <div class="objectLine right">
                <span class="err"> Steps changed! </span>
                <button class="aButton b4 right" onclick="window.location.href='/pipelines/new/'">
                    <strong>Save changes</strong>
                </button>
            </div>
        </div>
        <table id="" class="fixTable textCenter ">
            <thead>
                <tr class="s20">
                    <th class="minCol cell110">Pos</th>
                    <th class="cell1">Steps' Name</th>
                    <th class="minSmallCol ">Move</th>
                    <th class="minCol finalHeaderCell">Delete</th>
                </tr>
            </thead>
            <tbody>
                {% for aStep in thePipeline.steps() %}
                {% if loop.index0==thePipeline.hasAlgorithm %}
                <tr class="boldText">
                    {% else %}
                <tr>
                    {% endif %}

                    <td class="minCol cell110">{{loop.index}}</td>
                    <td class="cell1 textCenter">
                        {{ aStep[0] }}</td>
                    <td class="minSmallCol">
                        <a href="get{{loop.index0}}/">
                            &#8657;
                        </a> |
                        <a href="get{{loop.index0}}/">
                            &#8659;
                        </a>
                    </td>
                    <td class="minSmallCol">
                        <a href="get{{loop.index0}}/">
                            &#128465;
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <div class="yesMargin objectLine alingTop textLeft">
        <div class="yesMargin objectLine object2">
            <div>
                <label for="newName">Pipeline's name:</label> <br>
                <input type="text" name="newName" value="{{ thePipeline.Name}}" maxlength="100">
            </div>
            <button class="aButton b3 right roundBorder yesPadding" type="submit">
                Change name
            </button>
        </div>
        <div class="yesMargin objectLine object2">
            <div>
                <label for="newName">New pipeline's name:</label> <br>
                <input type="text" name="newName" value="{{newName}}">
            </div>

            <div class="err">
                {% if errors %}
                <p> Error adding a new Pipeline:
                    {% for e in errors %}
                    <br>- {{e}}
                    {% endfor %}
                </p>
                {% endif %}
            </div>
            <button class="aButton b2 s18 right roundBorder yesPadding" type="submit">
                Create pipeline
            </button>
        </div>
    </div>
</form>

{% endblock %}


{% block funcionesJS %}
<script src="{{url_for('static', filename='js/pipelines.js')}}" defer>

    // thePipe = {{thePipeline.Name}};
</script>

<!-- <script type="text/javascript"> -->
<script>
    // var thePipe = {{ thePipeline.Name }};
    var thePipe = JSON.parse('{{ thePipeline|tojson|safe }}');
    // var thePipe = JSON.eval('{{ thePipeline.Name|safe  }}');

    // const jsArrayOfItems = JSON.parse('{{ content|tojson|safe }}');

</script>
{% endblock %}